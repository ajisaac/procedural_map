Want to rewrite all of this and figure out what it all does, how it could be better
